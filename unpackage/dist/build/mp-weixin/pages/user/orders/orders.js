(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/user/orders/orders"],{2035:function(t,e,o){"use strict";var i=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("view",[o("view",{staticClass:"top_tap"},t._l(t.tabs,function(e,i){return o("view",{key:i,staticClass:"top_tap_item",class:t.currentTab==i?"on":"",attrs:{eventid:"102e15df-0-"+i},on:{tap:function(e){t.tabChange(i)}}},[t._v(t._s(e)),o("view",{staticClass:"line"})])})),t._l(t.list,function(e,i){return o("view",{key:i,staticClass:"order-item"},[o("navigator",{attrs:{url:"order-detail/order-detail?id="+e.id}},[o("view",{staticClass:"order-item-state padding-content flex-con justify-bet"},[t._v(t._s(e.create_time_text)),o("view",{staticClass:"order-item-text"},[t._v(t._s(e.operable.status_text))])]),o("view",{staticClass:"order-item-goods"},t._l(e.goods_info,function(t,e){return o("goodsCard",{key:e,attrs:{goodsinfo:t,mpcomid:"102e15df-0-"+i+"-"+e}})}))]),o("view",{staticClass:"order-item-state padding-content flex-con justify-bet"},[o("view",{staticClass:"order-item-cost flex-con"},[t._v(t._s(e.pay_status?"实付款: ":"应付款: ")),o("view",[t._v("￥"+t._s(e.pay_status?e.pay_amount:e.order_amount))])]),o("view",{staticClass:"order-item-btns flex-con"},t._l(e.operable.btn,function(n,a){return o("button",{key:a,class:{confirm:"pay"==n.operate||"confirm"==n.operate},attrs:{eventid:"102e15df-1-"+i+"-"+a},on:{tap:function(o){t.operate(e.id,i,n.operate)}}},[t._v(t._s(n.name))])}))])],1)}),t.popUp?o("view",{staticClass:"popup",attrs:{eventid:"102e15df-2"},on:{touchmove:function(e){e.stopPropagation(),e.preventDefault(),t.moveHandle(e)},tap:t.hidePop}}):t._e(),t.popUp?o("view",{staticClass:"diyModal flex-con-col",attrs:{eventid:"102e15df-4"},on:{touchmove:function(e){e.stopPropagation(),e.preventDefault(),t.moveHandle(e)}}},[o("view",{staticClass:"diyModal-title padding-content"},[t._v("已付款订单请联系客服取消~")]),o("view",{staticClass:"diyModal-btn flex-con"},[o("button",{attrs:{eventid:"102e15df-3"},on:{tap:t.hidePop}},[t._v("取消")]),o("button",{attrs:{"open-type":"contact"}},[t._v("确定")])],1)]):t._e(),o("loadMore",{attrs:{loadingType:t.loadingType,contentText:t.contentText,mpcomid:"102e15df-1"}}),o("loading",{attrs:{isLoading:t.isLoading,mpcomid:"102e15df-2"}}),o("naData",{attrs:{nodata:t.nodata,nodataText:t.nodataText,mpcomid:"102e15df-3"}})],2)},n=[];o.d(e,"a",function(){return i}),o.d(e,"b",function(){return n})},4135:function(t,e,o){"use strict";var i=o("fcfc"),n=o.n(i);n.a},"5c91":function(t,e,o){"use strict";o.r(e);var i=o("ac37"),n=o.n(i);for(var a in i)"default"!==a&&function(t){o.d(e,t,function(){return i[t]})}(a);e["default"]=n.a},6651:function(t,e,o){"use strict";o.r(e);var i=o("2035"),n=o("5c91");for(var a in n)"default"!==a&&function(t){o.d(e,t,function(){return n[t]})}(a);o("4135");var s=o("2877"),r=Object(s["a"])(n["default"],i["a"],i["b"],!1,null,null,null);e["default"]=r.exports},ac37:function(t,e,o){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=r(o("3764")),n=r(o("fa81")),a=r(o("1473")),s=r(o("9110"));function r(t){return t&&t.__esModule?t:{default:t}}var c={components:{goodsCard:n.default,loadMore:a.default,naData:s.default,loading:i.default},data:function(){return{currentTab:0,page_num:1,page_size:5,list:[],nodata:!1,nodataText:"还没有相关订单哦~",tabs:["全部","待付款","待发货","待收货","已完成"],loadingType:0,upDate:!1,popUp:!1,isLoading:!1}},onLoad:function(t){if(t.tabIndex){var e=Number(t.tabIndex)+1;this.currentTab=e}this.showLoading(),this.getList()},onShow:function(){this.upDate&&(this.list=[],this.getList())},onHide:function(){this.popUp=!1},onPullDownRefresh:function(){var e=this;this.loadingType=0,setTimeout(function(){e.list=[],e.page_num=1,e.getList(),t.stopPullDownRefresh()},800)},onReachBottom:function(){if(0===this.loadingType){this.loadingType=1;this.page_num;this.page_num=this.page_num+1,console.log(this.page_num),this.getList()}},methods:{tabChange:function(t){this.currentTab=t,this.loadingType=0,this.page_num=1,this.list=[],this.showLoading(),this.getList()},showLoading:function(){var t=this;this.isLoading=!0,console.log(this.isLoading),setTimeout(function(){t.isLoading=!1,console.log(t.isLoading)},800)},getList:function(){var t=this;this.nodata=!1,this.$api.get("/api/order/getList",{page_num:this.page_num,page_size:this.page_size,step:this.currentTab},function(e){if(console.log(e),200==e.data.code){var o=t.list,i=e.data.data;setTimeout(function(e){0==o.length?(t.loadingType=0,i.length<=0?t.nodata=!0:t.list=i):i.length<=0?t.loadingType=2:(t.loadingType=0,t.list=o.concat(i))},800)}})},operate:function(e,o,i){var n=this;console.log(e,i),"call_cancel"==i?n.popUp=!0:"pay"==i?n.doPay(e,o):"invoice"==i?n.scanInvoice(e,o):"cancel"==i?t.showModal({title:"确认取消订单吗?",confirmColor:"#e9101f",success:function(t){t.confirm&&n.sendOP(e,o,i)}}):"delete"==i||"remove"==i?t.showModal({title:"确认删除订单吗?",confirmColor:"#e9101f",success:function(t){t.confirm&&n.sendOP(e,o,i)}}):"reset"==i?n.sendOP(e,o,i):"again"==i?n.sendOP(e,o,i):"delivery"==i?t.navigateTo({url:"logistics/logistics?id="+e}):"confirm"==i&&t.showModal({title:"确认收货吗?",confirmColor:"#e9101f",success:function(t){t.confirm&&n.sendOP(e,o,i)}})},sendOP:function(e,o,i){var n=this;this.$api.get("/api/order/operate",{order_id:e,operate:i},function(a){if(console.log(a),200==a.data.code)if(t.showToast({title:a.data.msg}),"again"==i)t.switchTab({url:"/pages/tabbar/tabbar-3/tabbar-3"});else if("delete"==i||"remove"==i){var s=n.list;s.splice(o,1),n.list=s}else n.renewRow(e,o);else t.showToast({title:a.data.msg,icon:"none"})})},doPay:function(e,o){var i=this;this.$api.post("/api/miniprogram.payment/unifiedOrder",{order_id:e},function(n){if(console.log(n),200==n.data.code){var a=n.data.data;a.success=function(){t.showToast({title:"支付成功!"}),i.renewRow(e,o)},a.fail=function(){t.showToast({title:"您取消了支付",icon:"none"})},t.requestPayment(a)}else t.showToast({title:n.data.msg,icon:"none"})})},renewRow:function(t,e){var o=this;this.$api.get("/api/order/renewRow",{order_id:t},function(t){if(200==t.statusCode){var i=o.list;i[e]=t.data.data,o.list=[],o.list=i}})},hidePop:function(){this.popUp=!1},scanInvoice:function(e,o){var i=[];i[0]=this.list[o].invoice_file_url,t.previewImage({current:i[0],urls:i})}}};e.default=c}).call(this,o("543d")["default"])},b6f0:function(t,e,o){"use strict";o("c0c8");var i=a(o("b0ce")),n=a(o("6651"));function a(t){return t&&t.__esModule?t:{default:t}}Page((0,i.default)(n.default))},fcfc:function(t,e,o){}},[["b6f0","common/runtime","common/vendor"]]]);