(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/user/orders/order-detail/order-detail"],{"4d79":function(t,e,o){"use strict";o("c0c8");var i=s(o("b0ce")),a=s(o("7d5b"));function s(t){return t&&t.__esModule?t:{default:t}}Page((0,i.default)(a.default))},"7d5b":function(t,e,o){"use strict";o.r(e);var i=o("f750"),a=o("bbfd");for(var s in a)"default"!==s&&function(t){o.d(e,t,function(){return a[t]})}(s);o("a380");var n=o("2877"),r=Object(n["a"])(a["default"],i["a"],i["b"],!1,null,null,null);e["default"]=r.exports},a380:function(t,e,o){"use strict";var i=o("cb11"),a=o.n(i);a.a},bbfd:function(t,e,o){"use strict";o.r(e);var i=o("bdcb"),a=o.n(i);for(var s in i)"default"!==s&&function(t){o.d(e,t,function(){return i[t]})}(s);e["default"]=a.a},bdcb:function(t,e,o){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=a(o("fa81"));function a(t){return t&&t.__esModule?t:{default:t}}var s={components:{goodsCard:i.default},data:function(){return{id:"",order:{},cost:"",address:{},btn:[],open_area:0,customerOnline:!0,tipContent:"",showPop:!1,popUp:!1,timer:{},orderStatusNum:0,orderStatus:[{color:"#FFFFFF",title:"",subtitle:""},{color:"#CB0E0E",title:"等待买家付款",subtitle:"订单将于 --:--:-- 后自动关闭"},{color:"#737A81",title:"交易关闭",subtitle:"用户已取消"},{color:"#28BC83",title:"交易成功",subtitle:"欢迎再次光临！"},{color:"#737A81",title:"交易关闭",subtitle:"系统关闭"},{color:"#4483EB",title:"卖家已发货",subtitle:"订单将于 --:--:-- 后自动收货"},{color:"#CB0E0E",title:"等待卖家发货",subtitle:"卖家正在处理订单,即将发货！"}]}},onLoad:function(t){this.id=t.id,this.getOrder()},onShow:function(){this.getCustomerTime()},onHide:function(){this.popUp=!1},onUnload:function(){clearInterval(this.tiktok)},methods:{getOrder:function(){var t=this;this.$api.get("/api/order/getRow",{order_id:this.id},function(e){if(console.log(e),200==e.data.code){var o=e.data.data;t.order=o,t.btn=o.operable.btn,o.consignee_info&&(t.address=o.consignee_info),t.orderState(o.order_status,o.pay_status,o.delivery_status)}})},orderState:function(t,e,o){t>1&&t<5&&(this.orderStatusNum=t),0==t&&(0==e&&0==o&&(this.orderStatusNum=1,this.order.pay_overtime?this.getTimer(this.order.pay_overtime):(this.orderStatus[1].title=this.order.operable.status_text,this.orderStatus[1].subtitle="")),1==e&&0==o&&(this.orderStatusNum=6)),1==t&&(1==e&&0==o&&(this.orderStatusNum=6),e&&o&&(this.orderStatusNum=5,this.getTimer(this.order.delivery_overtime)))},operate:function(e){var o=this;console.log(e),"call_cancel"==e?o.popUp=!0:"pay"==e?o.doPay():"invoice"==e?o.scanInvoice():"cancel"==e?t.showModal({title:"确认取消订单吗?",confirmColor:"#e9101f",success:function(t){t.confirm&&o.sendOP(e)}}):"delete"==e||"remove"==e?t.showModal({title:"确认删除订单吗?",confirmColor:"#e9101f",success:function(t){t.confirm&&o.sendOP(e)}}):"reset"==e?o.sendOP(e):"again"==e?o.sendOP(e):"delivery"==e?t.navigateTo({url:"../logistics/logistics?id="+o.id}):"confirm"==e&&t.showModal({title:"确认收货吗?",confirmColor:"#e9101f",success:function(t){t.confirm&&o.sendOP(e)}})},sendOP:function(e){var o=this;this.$api.get("/api/order/operate",{order_id:this.id,operate:e},function(i){if(console.log(i),200==i.data.code){if(t.showToast({title:i.data.msg}),"delete"==e||"remove"==e)return t.navigateBack();"again"==e&&t.switchTab({url:"/pages/tabbar/tabbar-3/tabbar-3"});var a=getCurrentPages(),s=a[a.length-2];s.$vm.upDate=!0,o.getOrder()}else t.showToast({title:i.data.msg,icon:"none"})})},doPay:function(){var e=this;this.$api.post("/api/miniprogram.payment/unifiedOrder",{order_id:this.id},function(o){if(console.log(o),200==o.data.code){var i=o.data.data;i.success=function(){t.showToast({title:"支付成功!"}),e.getOrder()},i.fail=function(){t.showToast({title:"您取消了支付",icon:"none"})},t.requestPayment(i)}else t.showToast({title:o.data.msg,icon:"none"})})},getCustomerTime:function(){var t=this;this.$api.get("/api/common/getContent",{},function(e){console.log(e),200==e.data.code&&(t.customerOnline=e.data.data.customer_online.flag)})},isShowTip:function(e,o,i){1==e?this.customerOnline||(this.tipContent="当前不在工作时间范围内，请您晚点再来咨询呀~",this.showPop=!0):t.navigateTo({url:"/pages/goods_detail/goods_detail?id="+o+"&field="+i})},hidePop:function(){this.showPop=!1,this.popUp=!1},godetail:function(e,o){0!=o&&this.open_area!=o?t.showToast({title:"当前专区未开放，您暂时还无法查看该商品",icon:"none"}):t.navigateTo({url:"/pages/goods_detail/goods_detail?id="+e+"&field="+o})},scanInvoice:function(e,o){var i=[];i[0]=this.order.invoice_file_url,t.previewImage({current:i[0],urls:i})},getTimer:function(t){var e=this,o={};e.tiktok=setInterval(function(){var i=t-Math.round(new Date/1e3);o.h=Math.floor(i/3600%24)<10?"0"+Math.floor(i/3600%24):Math.floor(i/3600%24),o.m=Math.floor(i/60%60)<10?"0"+Math.floor(i/60%60):Math.floor(i/60%60),o.s=Math.floor(i%60)<10?"0"+Math.floor(i%60):Math.floor(i%60),o.d=Math.floor(i/3600/24),1==e.orderStatusNum?e.orderStatus[1].subtitle="订单将于 "+o.h+":"+o.m+":"+o.s+" 后自动关闭":e.orderStatus[5].subtitle="订单将于 "+o.d+"天"+o.h+":"+o.m+":"+o.s+" 后自动收货",e.timer=o,e.clearTimer()},1e3)},clearTimer:function(){var t=this,e=this.timer,o="";"00"==e.h&&"00"==e.m&&"00"==e.s&&(clearInterval(t.tiktok),o=1==t.orderStatusNum?"/api/order/closeOrder":"/api/order/receiveOrder",t.$api.get(o,{order_id:t.id},function(e){console.log(e),200==e.data.code&&t.getOrder()}))}}};e.default=s}).call(this,o("543d")["default"])},cb11:function(t,e,o){},f750:function(t,e,o){"use strict";var i=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("view",[o("view",{staticClass:"padding-content flex-con-col order-state",style:{backgroundColor:t.orderStatus[t.orderStatusNum].color}},[o("view",{staticClass:"order-state-title"},[t._v(t._s(t.orderStatus[t.orderStatusNum].title))]),o("view",{staticClass:"order-state-subtitle"},[t._v(t._s(t.orderStatus[t.orderStatusNum].subtitle))])]),t.address.name?o("view",{staticClass:"padding-content flex-con address"},[o("view",{staticClass:"address-edit"}),o("view",{staticClass:"address-info"},[o("view",{staticClass:"address-name flex-con"},[t._v(t._s(t.address.name)),o("view",{staticClass:"address-phone"},[t._v(t._s(t.address.phone))])]),o("view",{staticClass:"address-detail flex-con"},[t._v(t._s(t.address.address))])])]):t._e(),o("view",{staticClass:"content martop20 padding-content orders-goods-wrap"},[o("view",{staticClass:"order-item-goods"},t._l(t.order.goods_info,function(e,i){return o("view",{key:i,attrs:{eventid:"5be0d316-0-"+i},on:{tap:function(o){t.isShowTip(2,e.field_id,e.field)}}},[o("goodsCard",{attrs:{goodsinfo:e,mpcomid:"5be0d316-0-"+i}})],1)}))]),o("view",{staticClass:"content padding-content menu menu-title remark"},[t._v("留言:"),o("view",[t._v(t._s(t.order.remark?t.order.remark:"无"))])]),o("view",{staticClass:"content martop20 padding-top20"},[o("view",{staticClass:"info-item flex-con justify-bet"},[t._v("商品金额"),o("view",[t._v("￥"+t._s(t.order.goods_total))])]),o("view",{staticClass:"info-item flex-con justify-bet"},[t._v("支付方式"),o("view",[o("text",[t._v("￥"+t._s(t.order.order_amount))]),t.order.coin_total>0?o("text",[t._v("+"+t._s(t.order.coin_total)+"购物币")]):t._e(),t.order.point_total>0?o("text",[t._v("+"+t._s(t.order.point_total)+"积分")]):t._e()])]),o("view",{staticClass:"info-item flex-con justify-bet"},[t._v("运费"),o("view",[t._v("￥"+t._s(t.order.freight))])])]),o("view",{staticClass:"content padding-content menu menu-title goods-total"},[t._v("共"+t._s(t.order.goods_num)+"件商品"),o("view",[t._v("合计："),o("text",[t._v("￥"+t._s(t.order.order_amount))]),t.order.coin_total>0?o("text",[t._v("+"+t._s(t.order.coin_total)+"购物币")]):t._e(),t.order.point_total>0?o("text",[t._v("+"+t._s(t.order.point_total)+"积分")]):t._e(),t.order.freight>0?o("text",[t._v("+"+t._s(t.order.freight)+"运费")]):t._e()])]),o("view",{staticClass:"content martop20"},[o("view",{staticClass:"padding-content menu menu-title"},[t._v("订单信息")]),o("view",{staticClass:"padding-top20"},[o("view",{staticClass:"info-item flex-con"},[t._v("订单编号:"),o("view",[t._v(t._s(t.order.order_no))])]),o("view",{staticClass:"info-item flex-con"},[t._v("创建时间:"),o("view",[t._v(t._s(t.order.create_time_text))])]),t.order.pay_time_text?o("view",{staticClass:"info-item flex-con"},[t._v("支付时间:"),o("view",[t._v(t._s(t.order.pay_time_text))])]):t._e()])]),o("view",{staticClass:"content padding-content contact"},[o("image",{attrs:{src:"/static/img/common_icon_call.png",mode:"widthFix"}}),t._v("联系客服"),t.customerOnline?o("button",{attrs:{"open-type":"contact"}},[t._v("1")]):o("button",{attrs:{eventid:"5be0d316-1"},on:{tap:function(e){t.isShowTip(1)}}})],1),o("view",{staticClass:"content padding-content flex-con order-item-btns"},t._l(t.btn,function(e,i){return o("button",{key:i,class:{confirm:"pay"==e.operate||"confirm"==e.operate},attrs:{eventid:"5be0d316-2-"+i},on:{tap:function(o){t.operate(e.operate)}}},[t._v(t._s(e.name))])})),t.showPop?o("view",{staticClass:"tip-wrap",attrs:{eventid:"5be0d316-4"},on:{touchmove:function(e){e.stopPropagation(),e.preventDefault(),t.moveHandle(e)}}},[o("view",{staticClass:"tip-box flex-con-col"},[o("view",{staticClass:"tip-title"},[t._v(t._s(t.tipContent))]),o("button",{staticClass:"tip_confirm_btn",attrs:{eventid:"5be0d316-3"},on:{tap:t.hidePop}},[o("text",[t._v("我知道了")])])],1)]):t._e(),t.popUp?o("view",{staticClass:"popup",attrs:{eventid:"5be0d316-5"},on:{touchmove:function(e){e.stopPropagation(),e.preventDefault(),t.moveHandle(e)},tap:t.hidePop}}):t._e(),t.popUp?o("view",{staticClass:"diyModal flex-con-col",attrs:{eventid:"5be0d316-7"},on:{touchmove:function(e){e.stopPropagation(),e.preventDefault(),t.moveHandle(e)}}},[o("view",{staticClass:"diyModal-title padding-content"},[t._v("已付款订单请联系客服取消~")]),o("view",{staticClass:"diyModal-btn flex-con"},[o("button",{attrs:{eventid:"5be0d316-6"},on:{tap:t.hidePop}},[t._v("取消")]),o("button",{attrs:{"open-type":"contact"}},[t._v("确定")])],1)]):t._e()])},a=[];o.d(e,"a",function(){return i}),o.d(e,"b",function(){return a})}},[["4d79","common/runtime","common/vendor"]]]);