(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/user/aftersales/apply/apply"],{"137c":function(t,i,e){"use strict";(function(t){Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n=c(e("3764")),a=c(e("fa81")),o=c(e("c4ce")),s=c(e("b02e"));function c(t){return t&&t.__esModule?t:{default:t}}var l={components:{goodsCard:a.default,loading:n.default},data:function(){return{type:1,num:1,showNum:!1,content:"",imgpath:[],info:{},contact_info:{},applyimg:[],isLoading:!1,apptype:[{id:1,name:"换货",img_sel:"/static/img/exchange_sel.png",img_nor:"/static/img/exchange_nor.png"},{id:2,name:"退货",img_sel:"/static/img/return_sel.png",img_nor:"/static/img/return_nor.png"}]}},onLoad:function(t){this.id=t.id,this.getInfo()},methods:{currentTab:function(t){this.type=t,console.log(this.type)},setGoodsNum:function(i){if(this.num=i.num,this.num>this.info.number)return this.num=this.info.number,t.showToast({title:"已超过订单商品数量",icon:"none"})},getInfo:function(){var i=this;this.$api.get("/api/aftersale/getDataToApply",{order_goods_id:this.id},function(e){200==e.data.code?(i.info=e.data.data,e.data.data.number>1?(i.num=e.data.data.number,i.showNum=!0):i.info.num=e.data.data.number,i.contact_info=e.data.data.contact_info):t.showToast({title:e.data.msg,icon:"none"}),console.log(e)})},choose_img:function(i){var e=this,n=(this.imgpath,this.applyimg);if(n.length>=5)return t.showToast({title:"最多选择五张照片~",icon:"none"});t.chooseImage({count:1,sizeType:["original","compressed"],sourceType:["album","camera"],success:function(t){var i=t.tempFilePaths;e.upimg(i[0],i)}})},upimg:function(i,e){this.isLoading=!0;var n=s.default.getUserCookie(),a="";if(n){var c=0;for(var l in n)0!==c&&(a+=" "),a+=l+"="+n[l],c++}var d=this,u=this.imgpath,r=this.applyimg;t.uploadFile({url:o.default.baseUrl+"/api/common/upload",filePath:i,name:"file",header:{Cookie:a},success:function(t){console.log(t);var i=JSON.parse(t.data);console.log(i),200==i.code&&(d.isLoading=!1,u.push(e),d.imgpath=u,r.push(i.data.url),d.applyimg=r,console.log(r))}})},delete_img:function(t){console.log(this.applyimg[t]),this.$api.post("/api/common/delImage",{image_url:this.applyimg[t]},function(t){console.log(t),t.data.code});var i=this.applyimg,e=this.imgpath;i.splice(t,1),e.splice(t,1),this.applyimg=i,this.imgpath=e},textdown:function(t){this.content=t.detail.value},submit:function(){if(""==this.content)return t.showToast({title:"请填写申请原因",icon:"none"});var i={order_goods_id:this.id,number:this.num,type:this.type,reason:this.content,images:this.applyimg.join(",")};t.showLoading({title:"正在提交"}),this.$api.post("/api/aftersale/submitApply",i,function(i){if(console.log(i),t.hideLoading(),200==i.data.code){t.showToast({title:"提交成功！",duration:1e3,mask:!0});var e=getCurrentPages(),n=e[e.length-2];n.$vm.upDate=!0,setTimeout(function(){t.navigateBack()},1e3)}else t.showToast({title:i.data.msg,icon:"none",duration:1e3,mask:!0})})}}};i.default=l}).call(this,e("543d")["default"])},"746d":function(t,i,e){"use strict";var n=e("e204"),a=e.n(n);a.a},"7c94":function(t,i,e){"use strict";e.r(i);var n=e("137c"),a=e.n(n);for(var o in n)"default"!==o&&function(t){e.d(i,t,function(){return n[t]})}(o);i["default"]=a.a},e204:function(t,i,e){},e98c:function(t,i,e){"use strict";e("c0c8");var n=o(e("b0ce")),a=o(e("eeb8"));function o(t){return t&&t.__esModule?t:{default:t}}Page((0,n.default)(a.default))},edb4:function(t,i,e){"use strict";var n=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("view",[e("view",{staticClass:"order-item"},[e("view",{staticClass:"order-item-goods"},[e("goodsCard",{attrs:{goodsinfo:t.info,showNum:t.showNum,num:t.num,eventid:"707497c4-0",mpcomid:"707497c4-0"},on:{itemNum:t.setGoodsNum}})],1)]),e("view",{staticClass:"content martop20"},[e("view",{staticClass:"menu padding-content font-bold"},[t._v("选择售后类型")]),e("view",{staticClass:"padding-content flex-con justify-bet"},t._l(t.apptype,function(i,n){return e("view",{key:n,staticClass:"type-btn flex-con justify-center",class:i.id==t.type?"sel":"",attrs:{eventid:"707497c4-1-"+n},on:{tap:function(e){t.currentTab(i.id)}}},[e("image",{attrs:{src:i.id==t.type?i.img_sel:i.img_nor,mode:"widthFix"}}),t._v(t._s(i.name))])}))]),e("view",{staticClass:"content"},[e("view",{staticClass:"menu padding-content font-bold"},[t._v("申请原因")]),e("view",{staticClass:"content padding-content"},[e("view",{staticClass:"text-container padding-top20"},[e("textarea",{attrs:{placeholder:"请描述售后服务的具体原因~",eventid:"707497c4-2"},on:{input:t.textdown}})]),e("view",{staticClass:"img_box"},[t._l(t.imgpath,function(i,n){return e("view",{key:n,staticClass:"choose_img nobord flex-con-col"},[e("image",{staticClass:"upload_img",attrs:{src:i,mode:"widthFix"}}),e("view",{staticClass:"img_delete_btn",attrs:{eventid:"707497c4-3-"+n},on:{tap:function(i){t.delete_img(n)}}},[e("image",{attrs:{src:"/static/img/common_del.png",mode:"widthFix"}})])])}),e("view",{staticClass:"choose_img flex-con-col",attrs:{eventid:"707497c4-4"},on:{tap:t.choose_img}},[e("image",{staticClass:"photo_icon",attrs:{src:"/static/img/common_camare.png",mode:"widthFix"}}),t._v("添加图片"),e("view",[t._v("(最多5张)")])])],2)])]),e("view",{staticClass:"content"},[e("view",{staticClass:"menu padding-content font-bold"},[t._v("联系人")]),e("view",{staticClass:"padding-content"},[e("view",{staticClass:"padding-top20 flex-con contact-item"},[e("view",{staticClass:"contact"},[t._v("姓名：")]),t._v(t._s(t.contact_info.name))]),e("view",{staticClass:"padding-top20 flex-con contact-item"},[e("view",{staticClass:"contact"},[t._v("联系电话：")]),t._v(t._s(t.contact_info.phone))])])]),t._m(0),e("view",{staticClass:"padding-top20 martop20"},[e("button",{staticClass:"big-btn",attrs:{eventid:"707497c4-5"},on:{tap:function(i){t.submit()}}},[t._v("提交")])],1),e("loading",{attrs:{isLoading:t.isLoading,mpcomid:"707497c4-1"}})])},a=[function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("view",{staticClass:"padding-top20 martop20 flex-con-col sub-tips"},[t._v("提交申请后，售后专员可能与您电话沟通，"),e("view",[t._v("请保持手机畅通")])])}];e.d(i,"a",function(){return n}),e.d(i,"b",function(){return a})},eeb8:function(t,i,e){"use strict";e.r(i);var n=e("edb4"),a=e("7c94");for(var o in a)"default"!==o&&function(t){e.d(i,t,function(){return a[t]})}(o);e("746d");var s=e("2877"),c=Object(s["a"])(a["default"],n["a"],n["b"],!1,null,null,null);i["default"]=c.exports}},[["e98c","common/runtime","common/vendor"]]]);